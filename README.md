# enaza test app

```
Тестовое задание fullstack-разработчик

В бар приходят посетители выпивают и заказывают музыку. 
У каждого посетителя есть любимый жанр музыки.
Если играет композиция любимого жанра посетителя он идет танцевать, иначе он идет в бар и берет себе коктейли.

Необходимо эмулировать бар с произвольным кол-вом посетителей. 
Реализовать код, с помощью которого можно собрать в клуб определенную публику.
Желательно, чтобы код был расширяем.
Отображение процесса жизни бара произвести с помощью любого js-фреймворка, обновления сделать через ajax. Внешний вид (дизайн) не принципиален.
Результат должен быть проверяемым: должно быть понятно, какая музыка играет, и какой конкретно посетитель какие действия выполняет.
Проект должен быть загружен на github или gitlab или любой другой публичный сервис управления репозиториями. Процедура установки должна быть описана в Readme.md.

Дополнительно (не обязательно, но будет плюсом):
1. Наличие тестов;
2. Использование менеджера пакетов, как на backend, так и на frontend, сторонних библиотек и фреймворков;
3. Использование механизма мультипоточности/мультипроцессинга;
4. Возможность запрашивать текущее состояние бара;
5. Ограничение доступа, авторизация;
6. Настроенные docker-образа, docker-compose.
7. Фронтенд из двух страниц. Бар и Танцпол. Добавить в зафиксированном окне (в любой части экрана) журнал: при смене жанра музыки делать запись в журнал в формате [жанр - сколько людей танцевало - сколько людей было в баре]. Журнал копится до обновления страницы, т.е. только на фронтенде. Но при переходе между баром и танцполом его состояние должно сохраняться.

Если не успеваете выполнить дополнительные задачи, можете их описать отдельно, как бы вы их реализовывали, какие пункты важные, какие не стоит выполнять и почему.
```

# Установка

```
git clone git@github.com:razikov/enazaTest.git

cd ./enazaTest

cp .env.example .env и настроить

docker-compose pull

docker-compose up --detach --build

docker-compose run --rm node npm install

docker-compose run --rm node npm run build

docker-compose run --rm php composer install

docker-compose run --rm php ./yii migrate --interactive=0

docker-compose run --rm php ./yii data/init
```

## Запустить

```
docker-compose up --detach
```

## Остановить

```
docker-compose down --remove-orphans
```

## Тестирование

```
docker-compose run --rm node npm run test:unit

docker-compose run --rm node npm run test:e2e

// Перед запуском тестов надо развернуть базу. В команду ниже подставить своего пользователя и пароль

docker exec -it enaza-mysql mysql -u${MYSQL_USER} -p${MYSQL_PASSWORD} -e "CREATE DATABASE enaza_tests CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

docker-compose run --rm php composer test
```

## Линтинг

```
docker-compose run --rm node npm run lint
```

# Использование

Добавить в /etc/hosts хосты enaza-server.local и enaza-client.local

Документация для api тут http://enaza-server.local/api/v1/docs 

api-key для авторизации в api "Bearer 100-token"

Проверять работоспособность клиента тут http://enaza-client.local
